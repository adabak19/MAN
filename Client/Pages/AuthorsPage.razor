@page "/authors"
@using MAN.Shared.Interfaces;
@using MAN.Shared.Models;
@inject IAuthorService AuthorService
<h3>Authors</h3>

@if (authors == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <ul>
        @foreach (var author in authors)
        {
            <li>@author.FirstName @author.LastName</li>
        }
    </ul>
}

<button @onclick="AddAuthor">Add New Author</button>

@code {
    private List<Author>? authors;

    protected override async Task OnInitializedAsync()
    {
        // Load all authors when the page is initialized
        authors = await AuthorService.GetAllAsync();
    }

    private async Task AddAuthor()
    {
        var newAuthor = new Author
        {
            FirstName = "John",
            LastName = "Doe",
        };

        await AuthorService.Add(newAuthor);

        // Refresh the list of authors after adding a new one
        authors = await AuthorService.GetAllAsync();
    }
}